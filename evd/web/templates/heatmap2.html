{% extends 'new_base_temp.html' %}
<!DOCTYPE html>
<html>
{% block head %}
<style>
.navbar-wrapper{
    background:deepskyblue;
}
.main_heading{
    margin-bottom: 4%;
    text-align: center;
    //color:white;
    text-transform:uppercase;
    padding:20px;
    margin-top:15px;
    //background:deepskyblue;
    font-weight:bold;
}
.main_alert{
    border-radius:0 !important;
}
body{
    background: #f6f6f6 !important;
}
.stepwise > .col-md-6{
    margin-bottom:20px;
}
.role_specific_count th{
    text-align:center;
}
h5{
    font-weight:bold !important;
}
h4{
    text-transform: uppercase;
}
.tot_count h3{
    font-weight:bold;
    color: #064390;
}
.hide_{
    visibility: hidden;
}
.date_filter label, .date_filter input{
    display: inline-block;
}
.language, .ref_channel, .role{
    width: 15%;
    border-radius: 3px;
    height: 28px;
    background: inherit;
}

</style>
{{ block.super }}
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<!-- <link rel="stylesheet" href="http://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css"/>  -->
<link rel="stylesheet" href="/static/css_new/jquery-ui-minified.css"/> 
<link rel="stylesheet" href="/static/css_new/jquery-ui.min.css"/> 
<link rel="stylesheet" href="/static/css_new/jquery-ui-minified.theme.css"/>
<link rel="stylesheet" href="/static/css_new/jquery-ui.theme.min.css"/>
<link rel="stylesheet" href="/static/css_new/jquery-ui-minified.structure.css"/>
<link rel="stylesheet" href="/static/css_new/jquery-ui.structure.min.css"/>



{% endblock %}

{% block content %}

<div class="container" style="margin-top:85px">
    <div class="row">
        <div class="col-md-12">
            <!--<h3 class="main_heading">eVidyaloka Activity Analysis</h3>-->

            <div class="alert alert-success main_alert" style="margin-top:5%;color: black; background:white;">
                <h3 class="main_heading">Volunteer Management Analysis</h3>
                <!--choose month-->
                <div class="row">
                    <div class="col-md-12">
                       <div class="alert alert-success date_filter">
                         <div style="text-align:center;line-height: 40px;">
                            <label for="from_date">From: &nbsp;&nbsp;</label><input type="text" style='width:15%' id="from_date" name='from_date'>&nbsp;&nbsp;&nbsp;
                            <label for="to_date">To: &nbsp;&nbsp;</label><input type="text" id="to_date" style='width:15%'  name='to_date'>&nbsp;&nbsp;&nbsp;
                            <label for="language">Medium: &nbsp;&nbsp;</label>
                            <select class="language" id="language">
                              <option value="all">All</option>
                              {% for medium in language_list %}
                                <option value="{{medium}}" >{{medium}}</option>
                              {% endfor %}
                            </select>&nbsp;&nbsp;&nbsp;
                            <label for="ref_channel">Reference Channel: &nbsp;&nbsp;</label>
                            <select class="ref_channel" id="ref_channel">
                              <option value="all">All</option>
                              {% for ref in ref_channel_list %}
                                <option value={{ref.id}} >{{ref.referencechannel}}</option>
                              {% endfor %}
                            </select>&nbsp;&nbsp;&nbsp;<br/>
                            <label for="ref_channel">Role: &nbsp;&nbsp;</label>
                            <select class="role" id="role">
                              <option value="all">All</option>
                              {% for role in role_list %}
                                <option value="{{role}}" {% if role == 'Teacher' %}selected{% endif %}>{{role}}</option>
                              {% endfor %}
                            </select>&nbsp;&nbsp;&nbsp;
                            <button class="btn btn-info btn-sm filter_btn" style="height:29px;margin-top: -3px;">Submit</button>
                          </div>
                       </div><!--alert-->
                    </div><!--col-->
                </div><!--row-->
                <div class="row">
                        <div class="col-md-12">
                            <div class="alert alert-info">
                              <div class="row tot_count">
                                 <div class="col-md-12">
                                 <div class="row"><h4 style="text-align:center;color: black !important">Based On Joined Date</h4></div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Sign Ups</h5>
                                    <h3 class="count hide_">{{total_registred_joined_date.0}}</h3>
                                    <h5 class="percent hide_">{{total_registred_joined_date.1}}</h5>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>TSD's Booked</h5>
                                    <h3 class="count hide_">{{total_tsd_joined_date.0}}</h3>
                                    <h5 class="percent hide_">{{total_tsd_joined_date.1}}</h5>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Recommended</h5>
                                    <h3 class="count hide_">{{total_rec_joined_date.0}}</h3>
                                    <h5 class="percent hide_">{{total_rec_joined_date.1}}</h5>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Demand's Booked</h5>
                                    <h3 class="count hide_">{{total_demand_booked_joined_date}}</h3>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Assigned</h5>
                                    <h3 class="count hide_">{{total_demand_assigned_joined_date}}</h3>
                                </div>
                                <div class="col-md-2" style="text-align:center;">
                                    <h5>Dropped</h5>
                                    <h3 class="count hide_">{{total_demand_dropped_joined_date}}</h3>
                                </div>
                                 </div>
                                 <div class="col-md-12">
                                <div class="row"><h4 style="text-align:center;color: black !important">Based On Selected Dates</h4></div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Sign Ups</h5>
                                    <h3 class="count hide_">{{total_registred.0}}</h3>
                                    <h5 class="percent hide_">{{total_registred.1}}</h5>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>TSD's Booked</h5>
                                    <h3 class="count hide_">{{total_tsd.0}}</h3>
                                    <h5 class="percent hide_">{{total_tsd.1}}</h5>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Recommended</h5>
                                    <h3 class="count hide_">{{total_rec.0}}</h3>
                                    <h5 class="percent hide_">{{total_rec.1}}</h5>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Demand's Booked</h5>
                                    <h3 class="count hide_">{{total_demand_booked}}</h3>
                                </div>
                                <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                                    <h5>Assigned</h5>
                                    <h3 class="count hide_">{{total_demand_assigned}}</h3>
                                </div>
                                <div class="col-md-2" style="text-align:center;">
                                    <h5>Dropped</h5>
                                    <h3 class="count hide_">{{total_demand_dropped}}</h3>
                                </div>
                                 </div>
                              </div>
                            </div><!--alert-->
                        </div><!-- col -->
                </div><!-- row -->
                <!--end  -->
                <div class="row timeline">
                    <div id="timeline" style="min-width: 310px; height: 400px; margin: 0 auto">
                    </div>
                </div>
                <div class="row pie">
                    <div class="col-md-3" id="ref_channel_pie" style="min-width: 25px; height: 400px; margin: 0 auto">
                    </div>
                    <div class="col-md-3" id="language_pie" style="min-width: 250px; height: 400px; margin: 0 auto">
                    </div>
                    <div class="col-md-3" id="role_pie" style="min-width: 250px; height: 400px; margin: 0 auto">
                    </div>
                    <div class="col-md-3" id="role_outcome_pie" style="min-width: 250px; height: 400px; margin: 0 auto">
                    </div>
                </div><!--row pie -->
                <div class="row role_specific">
                    <div class="col-md-6">
                        <h4 class="">Role Specific Analysis</h4>
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered role_specific_count" style="text-align:center">
                                <thead class="bg-info">
                                  <tr>
                                    <th>Role ID</th>
                                    <th>Role</th>
                                    <th>Users Registred</th>
                                    <th>Users Completed all the Steps</th>
                                  </tr>
                                </thead>
                                <tbody>
                                 {% for id, details in rolewise_count.items %}
                                  <tr>
                                    <td>{{id}}</td>
                                    <td>{{details.name}}</td>
                                    <td>{{details.reg_count}}</td>
                                    <td>{{details.completed_count}}</td>
                                  </tr>
                                 {% endfor %}
                                </tbody>
                            </table>
                        </div><!-- table div -->
                    </div><!-- col -->

                    <div class="col-md-6">
                        <div id="role_specific_count_chart" style="margin-top:20px"></div>
                    </div>

                </div><!-- row -->
                <hr>
                <div class="stepwise">
                <div class="row">
                    <div class="col-md-12">
                        <h4 class="">Step wise Analysis</h4>
                    </div>

                    <div class="col-md-6">
                        <h5 class="">Teacher</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered" style="margin:0 auto;text-align:center">
                                <thead>
                                  <tr class="bg-info">
                                    <th>Step ID</th>
                                    <th>Step</th>
                                    <th>Weightage</th>
                                    <th>Users Completed</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {% if teacher_stepwise %}
                                    {% for step in teacher_stepwise %}
                                      <tr>
                                        <td>{{step.id}}</td>
                                        <td>{{step.stepname}}</td>
                                        <td>{{step.weightage}}</td>
                                        <td>{{step.count}}</td>
                                      </tr>
                                    {% endfor %}
                                  {% else %}
                                    <tr>
                                        <td colspan="4">No data available</td>
                                    </tr>
                                  {% endif %}
                                </tbody>
                            </table>
                        </div><!-- table div -->
                    </div><!-- col -->
                    <div class="col-md-6">
                        <h5 class="">Center Admin</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered" style="margin:0 auto;text-align:center">
                                <thead>
                                  <tr class="bg-info">
                                    <th>Step ID</th>
                                    <th>Step</th>
                                    <th>Weightage</th>
                                    <th>Users Completed</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {% if centeradmin_stepwise %}
                                    {% for step in centeradmin_stepwise %}
                                      <tr>
                                        <td>{{step.id}}</td>
                                        <td>{{step.stepname}}</td>
                                        <td>{{step.weightage}}</td>
                                        <td>{{step.count}}</td>
                                      </tr>
                                    {% endfor %}
                                  {% else %}
                                    <tr>
                                        <td colspan="4">No data available</td>
                                    </tr>
                                  {% endif %}
                                </tbody>
                            </table>
                        </div><!-- table div -->
                    </div><!-- col -->
                </div><!-- row -->
                <hr>
                <div class="row">
                   <br>
                    <div class="col-md-6">
                        <h5 class="">Content Developer</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered" style="margin:0 auto;text-align:center">
                                <thead>
                                  <tr class="bg-info">
                                    <th>Step ID</th>
                                    <th>Step</th>
                                    <th>Weightage</th>
                                    <th>Users Completed</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {% if contentdeveloper_stepwise %}
                                    {% for step in contentdeveloper_stepwise %}
                                      <tr>
                                        <td>{{step.id}}</td>
                                        <td>{{step.stepname}}</td>
                                        <td>{{step.weightage}}</td>
                                        <td>{{step.count}}</td>
                                      </tr>
                                    {% endfor %}
                                  {% else %}
                                    <tr>
                                        <td colspan="4">No data available</td>
                                    </tr>
                                  {% endif %}
                                </tbody>
                            </table>
                        </div><!-- table div -->
                    </div><!-- col -->
                    <div class="col-md-6">
                        <h5 class="">Well Wisher</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered" style="margin:0 auto;text-align:center">
                                <thead>
                                  <tr class="bg-info">
                                    <th>Step ID</th>
                                    <th>Step</th>
                                    <th>Weightage</th>
                                    <th>Users Completed</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {% if wellwisher_stepwise %}
                                    {% for step in wellwisher_stepwise %}
                                      <tr>
                                        <td>{{step.id}}</td>
                                        <td>{{step.stepname}}</td>
                                        <td>{{step.weightage}}</td>
                                        <td>{{step.count}}</td>
                                      </tr>
                                    {% endfor %}
                                  {% else %}
                                    <tr>
                                        <td colspan="4">No data available</td>
                                    </tr>
                                  {% endif %}
                                </tbody>
                            </table>
                        </div><!-- table div -->
                    </div><!-- col -->
                </div><!-- row -->
                <br><hr>
                <div class="row">
                    <br>
                    <div class="col-md-6">
                        <h5 class="">Content Admin</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered" style="margin:0 auto;text-align:center">
                                <thead>
                                  <tr class="bg-info">
                                    <th>Step ID</th>
                                    <th>Step</th>
                                    <th>Weightage</th>
                                    <th>Users Completed</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {% if contentadmin_stepwise %}
                                    {% for step in contentadmin_stepwise %}
                                      <tr>
                                        <td>{{step.id}}</td>
                                        <td>{{step.stepname}}</td>
                                        <td>{{step.weightage}}</td>
                                        <td>{{step.count}}</td>
                                      </tr>
                                    {% endfor %}
                                  {% else %}
                                    <tr>
                                        <td colspan="4">No data available</td>
                                    </tr>
                                  {% endif %}
                                </tbody>
                            </table>
                        </div><!-- table div -->
                    </div><!-- col -->
                    <div class="col-md-6">
                        <h5 class="">Class Assistant</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered" style="margin:0 auto;text-align:center">
                                <thead>
                                  <tr class="bg-info">
                                    <th>Step ID</th>    
                                    <th>Step</th>
                                    <th>Weightage</th>
                                    <th>Users Completed</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  {% if classassistant_stepwise %}
                                    {% for step in  classassistant_stepwise%}
                                      <tr>
                                        <td>{{step.id}}</td>
                                        <td>{{step.stepname}}</td>
                                        <td>{{step.weightage}}</td>
                                        <td>{{step.count}}</td>
                                      </tr>
                                    {% endfor %}
                                  {% else %}
                                    <tr>
                                        <td colspan="4">No data available</td>
                                    </tr>
                                  {% endif %}
                                </tbody>
                            </table>
                        </div><!-- table div -->
                    </div><!-- col -->

                </div><!-- row -->
                </div><!--stepwise-->
 

        </div><!--col-->
    </div><!--row-->
</div><!--container-->

{% endblock content %}

{% block scripts %}
    {{ block.super }}
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script type="text/javascript" src="/static/js_new/jquery-ui.min.js"></script>
<script type="text/javascript" src="/static/js/underscore-min.js"></script>
<!-- <script type="text/javascript" src="/static/js/bootstrap-datepicker.min.js"></script> -->
<!--<script type="text/javascript" src="/static/js/highcharts.js"></script> -->


<!-- COUNTER -->
<script>
function counting(){
    $('.count').each(function () {
      var that =$(this);
      that.removeClass("hide_");
      that.next(".percent").removeClass("hide_");
      jQuery({ Counter: 0 }).animate({ Counter: that.text() }, {
        duration: 5000,
        step: function () {
          that.text(Math.ceil(this.Counter));
        }
      });
    });
}
counting();
</script>

<!--underscore templates-->
<script id = "timeline_temp" type = "template">
    <div id="timeline" style="min-width: 310px; height: 400px; margin: 0 auto">
    </div>
</script>

<script id = "total_count_tmpl" type = "template">  
     <div class="row">
        <div class="col-md-12">
            <div class="alert alert-info">
                    <div class="row">
                    <div class="col-md-12">
                        <div class="row"><h4 style="text-align:center;color: black !important">Based On Joined Date</h4></div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Sign Ups</h5>
                            <h3 class="count hide_"><%= resp.total_registred_joined_date[0] %></h3>
                            <h5 class="percent hide_"><%= resp.total_registred_joined_date[1] %></h5>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>TSD's Booked</h5>
                            <h3 class="count hide_"><%= resp.total_tsd_joined_date[0] %></h3>
                            <h5 class="percent hide_"><%= resp.total_tsd_joined_date[1] %></h5>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Recommended</h5>
                            <h3 class="count hide_"><%= resp.total_rec_joined_date[0] %></h3>
                            <h5 class="percent hide_"><%= resp.total_rec_joined_date[1] %></h5>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Demand's Booked</h5>
                            <h3 class="count hide_"><%= resp.total_demand_booked_joined_date %></h3>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Assigned</h5>
                            <h3 class="count hide_"><%= resp.total_demand_assigned_joined_date %></h3>
                        </div>
                        <div class="col-md-2" style="text-align:center;">
                            <h5>Dropped</h5>
                            <h3 class="count hide_"><%= resp.total_demand_dropped_joined_date %></h3>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="row"><h4 style="text-align:center;color: black !important">Based On Selected Dates</h4></div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Sign Ups</h5>
                            <h3 class="count hide_"><%= resp.total_registred[0] %></h3>
                            <h5 class="percent hide_"><%= resp.total_registred[1] %></h5>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>TSD's Booked</h5>
                            <h3 class="count hide_"><%= resp.total_tsd[0] %></h3>
                            <h5 class="percent hide_"><%= resp.total_tsd[1] %></h5>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Recommended</h5>
                            <h3 class="count hide_"><%= resp.total_rec[0] %></h3>
                            <h5 class="percent hide_"><%= resp.total_rec[1] %></h5>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Demand's Booked</h5>
                            <h3 class="count hide_"><%= resp.total_demand_booked %></h3>
                        </div>
                        <div class="col-md-2" style="text-align:center;border-right:2px solid black">
                            <h5>Assigned</h5>
                            <h3 class="count hide_"><%= resp.total_demand_assigned %></h3>
                        </div>
                        <div class="col-md-2" style="text-align:center;">
                            <h5>Dropped</h5>
                            <h3 class="count hide_"><%= resp.total_demand_dropped %></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</script>
<script id="role_specific_tmpl" type="template">
    {% include "role_specific_analysis.tmpl" %}
</script>
<script id="step_wise_tmpl" type="template">
    {% include "step_wise_analysis.tmpl" %}
</script>

<script>
$(document).ready(function(){
    $('#from_date').datepicker({
        changeMonth : true,
        changeYear: true,
        dateFormat : "dd-mm-yy",
    }).datepicker("setDate", "{{from_date}}".split("-").reverse().join("-")) ;
$('#to_date').datepicker({changeMonth : true, changeYear: true, dateFormat : "dd-mm-yy"}).datepicker("setDate", "{{to_date}}".split("-").reverse().join("-")) ;

//filter
$("body").on("click", ".filter_btn", function(){
    data={'type':'filter', 'from_date': $("#from_date").val(), 'to_date': $("#to_date").val(),
          'language': $(".language").find("option:selected").val(), 'ref_channel': $(".ref_channel").find("option:selected").val(),
           'role': $(".role").find("option:selected").val(), 'ref_channel': $(".ref_channel").find("option:selected").val()}
    $.get('/volunteer_heatmap/', data, function(resp){
        console.log(resp);
        //timeline
        //var timeline_temp = $("#timeline_temp").html();
        //var compiledTemplate = _.template(timeline_temp);
        //var templateResult = compiledTemplate({'resp': resp});
        //var x = $(templateResult);
        //$(".timeline").html(x);

        //pie
        //var pie_temp = $("#pie_temp").html();
        //var compiledTemplate = _.template(pie_temp);
        //var templateResult = compiledTemplate();
        //var x = $(templateResult);
        //$(".pie").html(x);

        //main count
        var total_count_tmpl = $("#total_count_tmpl").html();
        var compiledTemplate = _.template(total_count_tmpl);
        var templateResult = compiledTemplate({'resp': resp});
        var x = $(templateResult);
        $(".tot_count").html(x);
        counting();

        //role specific analysis
        var role_specific_tmpl = $("#role_specific_tmpl").html();
        var compiledTemplate = _.template(role_specific_tmpl);
        var templateResult = compiledTemplate({'resp': resp});
        var x = $(templateResult);
        $(".role_specific").html(x);
        window.role_specific_chart();

        //step wise analysis
        var step_wise_tmpl = $("#step_wise_tmpl").html();
        var compiledTemplate = _.template(step_wise_tmpl);
        var templateResult = compiledTemplate({'resp': resp});
        var x = $(templateResult);
        $(".stepwise").html(x);

        //pie charts
        var ref_channel_pie_series = JSON.parse(resp.ref_channel_pie_series);
        var pref_medium_pie_series = JSON.parse(resp.pref_medium_pie_series);
        var role_pie_series        = JSON.parse(resp.role_pie_series);
        var role_outcome_pie_series = JSON.parse(resp.role_outcome_pie_series);
        // debugger;
        pie_chart("ref_channel_pie", "Reference Channel", ref_channel_pie_series);
        pie_chart("language_pie", "Language", pref_medium_pie_series);
        pie_chart("role_pie", "Role", role_pie_series);
        pie_chart("role_outcome_pie", "Role Outcome", role_outcome_pie_series);


        //timeline chart
        var timeline_series = JSON.parse(resp.timeline_series);
        timeline_graph(timeline_series);

    });
});//end click

//chart
$(window.role_specific_chart = function () {

    Highcharts.chart('role_specific_count_chart', {
        credits: false,
        exporting: false,
        colors: [
            '#ff0000',
            '#00ff00',
        ],
        data: {
            table: document.querySelectorAll('.role_specific_count')[0],
            startColumn:1,
            endColumn:3
        },
        chart: {
            type: 'column'
        },
        title: {
            text: ""
        },
        yAxis: {
            allowDecimals: false,
            title: {
                text: 'Count'
            }
        },
        tooltip: {
            formatter: function () {
                return '<b>' + this.series.name + '</b><br/>' +
                    this.point.y + ' ' + this.point.name.toLowerCase();
            }
        }
    });

//timeline chart call
var timeline_series = {{timeline_series|safe}};
timeline_graph(timeline_series);



});

});
var ref_channel_pie_series = {{ref_channel_pie_series|safe}};
var pref_medium_pie_series = {{pref_medium_pie_series|safe}};
var role_pie_series        = {{role_pie_series|safe}};
var role_outcome_pie_series = {{role_outcome_pie_series|safe}};
//pref_medium_pie_series[0]["data"] = JSON.parse(pref_medium_pie_series[0]["data"]);

pie_chart("ref_channel_pie", "Reference Channel", ref_channel_pie_series);
pie_chart("language_pie", "Language", pref_medium_pie_series);
pie_chart("role_pie", "Role", role_pie_series);
pie_chart("role_outcome_pie", "Role Outcome", role_outcome_pie_series);

//pie chart
function pie_chart(id, title, ref_channel_pie_series){

    Highcharts.chart(id, {
        credits: false,
        exporting: false,
        chart: {
            plotBackgroundColor: '#f6f6f6',
            plotBorderWidth: 'blue',
            plotShadow: false,
            type: 'pie'
        },
        title: {
            text: title
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage:.1f}% ({point.y:.if})</b>'
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: false,
                    format: '{point.y:.if} ( {point.percentage:.1f} % )',//'<b>{point.name}</b>: {point.y:.if} ( {point.percentage:.1f} % )',
                    style: {
                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                    }
                },
                showInLegend: true
            }
        },
        series: ref_channel_pie_series
    });


}//end pie

//timeline chart
function timeline_graph(timeline_series){
    Highcharts.chart('timeline', {
        credits: false,
        exporting: false,
        title: {
            text: 'Analysis',
            x: -20 //center
        },
        xAxis: {
            type: 'datetime',
            dateTimeLabelFormats: {
                month: '%d-%b-%Y',
                year: '%Y'
            }
        },
        yAxis: {
            title: {
                text: 'Count'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },
        tooltip: {
            valueSuffix: ' '
        },
        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
        },
        series: timeline_series
    });
}

</script>


{% endblock scripts %}

</html>
