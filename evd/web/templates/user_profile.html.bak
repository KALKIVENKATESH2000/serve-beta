{% extends "base.html" %}

{% load filters %}
{% load tags %}

{% block head_scripts %}
    {{ block.super }}
    <script src="/static/js/jquery-ui.min.js"></script>
    <script src="/static/js/bootstrap-carousel.js"></script>
    <script src="/static/js/bootstrap-transition.min.js"></script>
{% endblock %}

{% block head_styles %}
    {{ block.super }}
    <link rel="stylesheet" href="/static/css/jquery-ui.css"/>
    <style>
        .ui-widget-content .ui-icon {
            background-image:url('/static/images/ui-icons_222222_256x240.png');
        }
    </style>
{% endblock %}

{% block doc_ready %}
    {{ block.super }}
    $('.carousel').carousel({
        interval: false
    });
    window.evd.show_offerings = function(resp){
        /*$("#basic_info").hide();
        $("#offerings").show();*/
        var email = $("input[name='primary_email']").val();
        var phone = $("input[name='phone']").val()
        if(email && phone){
            $(".carousel").carousel("next");
        }
        else {
            alert("Please enter Email and phone number");
        }
    }
    window.evd.show_preferences = function(resp){
        /*$("#offerings").hide();
        $("#preferences").show();*/
        $(".carousel").carousel("next");
        var dates=[];
        $("#prefered_thisoffering").children(":selected").each(function(i,v){

            var start_date = $(this).attr("data-start_date");
            var end_date = $(this).attr("data-end_date");

            dates.push(new Date(start_date.substr(0,start_date.lastIndexOf(",")).replace(",","")));
            dates.push(new Date(end_date.substr(0,end_date.lastIndexOf(",")).replace(",","")));
            var subject = $(this).attr("data-subject");
            var medium = $(this).attr("data-medium");
            $("#medium").children("option[value='" + medium + "']").attr({"selected":"selected"});
            $("#prefered_subjects").children("option[value='" + subject + "']").attr({"selected":"selected"});
        });
        var start_date = new Date(Math.min.apply(null,dates));
        var end_date = new Date(Math.max.apply(null,dates));
        $("input[name='from_date']").val(start_date.getFullYear() + "-" + (start_date.getMonth()+1) + "-" + start_date.getDate());
        $("input[name='to_date']").val(end_date.getFullYear() + "-" + (end_date.getMonth()+1) + "-" + end_date.getDate());

    }
    window.evd.pre_profile_save = function(){
        var q = ""; 
        $("select[multiple='multiple']").each(function() {
            var $that = $(this);
            q = ""; 
            $.each($(this).children(":selected"), function(index,val) {
                    q += $(this).attr("value") + ( index < ($that.children(":selected").length - 1) ? ";" : "" );
            });
            $(this).prev().val(q);
        });

        q = "";
        days="";
        $.each($("div.timing-inner-wrapper"), function(index,val){
            q += $(this).children().eq(1).val() + "-" + $(this).children().eq(2).val() + ( index < ($("div.timing-inner-wrapper").length - 1) ? ";" : "");
            $("input[name='prefered_timings']").val(q);
            days += $(this).children().eq(0).val() + ( index < ($("div.timing-inner-wrapper").length - 1) ? ";" : "");
            $("input[name='prefered_days']").val(days);
        });
    }
{% endblock %}

{% block body_container %}
    <div id="myCarousel" class="carousel slide">
        <div class="carousel-inner">
            <div id="basic_info" class="item active">
                <div class="row">
                    <div class="span12 trans-block" style="min-height:500px;">
                       <form id="basic_info_form" class="form-horizontal" method="POST" action="/save_user_profile/" >
                                {% csrf_token %}
                                <input type="hidden" value="1" name="step"/>
                                <div class="row">
                                    <div class="span12" style="padding-top:30px">
                                        <h2 style="padding-left:50px;float:left">Your basic information</h2>
                                    </div>
                                    <div class="pull-right">
                                        <img src="{{user_profile.picture}}" alt="There is no image" style="width:100px;height:100px"/>
                                    </div>
                                    <div class="span5 offset1" style="padding-top:20px;">
                                        <div class="control-group control">
                                            <label class="control-label" for="input01" style="text-align:left;">Name</label>
                                            <div class="controls">
                                                <input type="text" class="input-small" id="input01" name="firstname" value="{{ user.first_name }}" >
                                                <input type="text" class="input-small" name="lastname" value="{{ user.last_name}}" style="margin-left:15px;"/>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="input01" style="text-align:left;">Email</label>
                                            <div class="controls">
                                                <input type="text" class="medium" id="input01" name="primary_email" value="{% if curr_user.email %}{{ curr_user.email }} {%else%}{{ user_profile.email }} {% endif %}">

                                            </div>
                                        </div>
                                         <div class="control-group">
                                            <label class="control-label" for="input01" style="text-align:left;">Phone</label>
                                            <div class="controls">
                                                <input type="text" class="medium" id="input01" name="phone" value="{% if user_profile %}{{ user_profile.phone }}{% endif %}">
                                            </div>
                                        </div>
                                        <div class="control-group control">
                                            <label class="control-label" for="input01" style="text-align:left;">Skype Id</label>
                                            <div class="controls">
                                                <input type="hidden" class="input-xlarge" id="input01" name="username" value="{{ user.username }}">
                                                <input type="text" class="medium" id="input01" name="skype_id" value="{% if user_profile %}{{ user_profile.skype_id }}{% endif %}">
                                            </div>
                                        </div>

                                    </div>
                                    <div class="span5" style="padding-top:20px;">
                                        <div class="control-group">
                                            <label class="control-label" for="select01" style="text-align:left;">Country</label>
                                                <div class="controls">
                                                    <select name="country" class="medium" style="margin-left: -80px;">
                                                        <!--<option value="xx">World wide</option>-->
                                                        <option value="af">Afghanistan</option>
                                                        <option value="dz">Algeria</option>
                                                        <option value="ar">Argentina</option>
                                                        <option value="au">Australia</option>
                                                        <option value="bd">Bangladesh</option>
                                                        <option value="br">Brazil</option>
                                                        <option value="cm">Cameroon</option>
                                                        <option value="ca">Canada</option>
                                                        <option value="co">Colombia</option>
                                                        <option value="dk">Denmark</option>
                                                        <option value="eg">Egypt</option>
                                                        <option value="et">Ethiopia</option>
                                                        <option value="fr">France</option>
                                                        <option value="de">Germany</option>
                                                        <option value="gh">Ghana</option>
                                                        <option value="gr">Greece</option>
                                                        <option value="in">India</option>
                                                        <option value="id">Indonesia</option>
                                                        <option value="iq">Iraq</option>
                                                        <option value="ie">Ireland</option>
                                                        <option value="il">Israel</option>
                                                        <option value="it">Italy</option>
                                                        <option value="jp">Japan</option>
                                                        <option value="ke">Kenya</option>
                                                        <option value="mg">Madagascar</option>
                                                        <option value="my">Malaysia</option>
                                                        <option value="mx">Mexico</option>
                                                        <option value="ma">Morocco</option>
                                                        <option value="mz">Mozambique</option>
                                                        <option value="np">Nepal</option>
                                                        <option value="nl">Netherlands</option>
                                                        <option value="nz">New Zealand</option>
                                                        <option value="ni">Nigeria</option>
                                                        <option value="pk">Pakistan</option>
                                                        <option value="pe">Peru</option>
                                                        <option value="ph">Philippines</option>
                                                        <option value="pl">Poland</option>
                                                        <option value="kr">Republic of Korea</option>
                                                        <option value="ro">Romania</option>
                                                        <option value="ru">Russia</option>
                                                        <option value="sa">Saudi Arabia</option>
                                                        <option value="sg">Singapore</option>
                                                        <option value="za">South Africa</option>
                                                        <option value="es">Spain</option>
                                                        <option value="lk">Sri Lanka</option>
                                                        <option value="se">Sweden</option>
                                                        <option value="ch">Switzerland</option>
                                                        <option value="tw">Taiwan</option>
                                                        <option value="tz">Tanzania</option>
                                                        <option value="th">Thailand</option>
                                                        <option value="tr">Turkey</option>
                                                        <option value="ug">Uganda</option>
                                                        <option value="ua">Ukraine</option>
                                                        <option value="gb">United Kingdom</option>
                                                        <option value="us">United States</option>
                                                        <option value="uz">Uzbekistan</option>
                                                        <option value="ve">Venezuela</option>
                                                        <option value="vn">Vietnam</option>
                                                        <option value="ye">Yemen</option>
                                                    </select>
                                                </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="select01" style="text-align:left;">State</label>
                                                <div class="controls">
                                                    <input type="text" class="medium" name="state" value="{% if user_profile %}{{ user_profile.state }}{% endif %}">
                                                </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="select01" style="text-align:left;">City</label>
                                                <div class="controls">
                                                    <input type="text" class="medium" name="city" value="{% if user_profile %}{{ user_profile.city }}{% endif %}">
                                                </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label" for="select01" style="text-align:left;">Time Zone</label>
                                                <div class="controls">
                                                   <select id="user_time_zone" name="time_zone" class="medium" style="margin-left: -80px;">
                                                      <option data-offset="-36000" value="Hawaii">(GMT-10:00) Hawaii</option>
                                                      <option data-offset="-32400" value="Alaska">(GMT-09:00) Alaska</option>
                                                      <option data-offset="-28800" value="Pacific Time (US &amp; Canada)">(GMT-08:00) Pacific Time (US &amp; Canada)</option>
                                                      <option data-offset="-25200" value="Arizona">(GMT-07:00) Arizona</option>
                                                      <option data-offset="-25200" value="Mountain Time (US &amp; Canada)">(GMT-07:00) Mountain Time (US &amp; Canada)</option>
                                                      <option data-offset="-21600" value="Central Time (US &amp; Canada)">(GMT-06:00) Central Time (US &amp; Canada)</option>
                                                      <option data-offset="-18000" value="Eastern Time (US &amp; Canada)">(GMT-05:00) Eastern Time (US &amp; Canada)</option>
                                                      <option data-offset="-18000" value="Indiana (East)">(GMT-05:00) Indiana (East)</option>
                                                      <option data-offset="" value="" selected="selected">-------------</option>
                                                      <option data-offset="-39600" value="International Date Line West">(GMT-11:00) International Date Line West</option>
                                                      <option data-offset="-39600" value="Midway Island">(GMT-11:00) Midway Island</option>
                                                      <option data-offset="-39600" value="Samoa">(GMT-11:00) Samoa</option>
                                                      <option data-offset="-28800" value="Tijuana">(GMT-08:00) Tijuana</option>
                                                      <option data-offset="-25200" value="Chihuahua">(GMT-07:00) Chihuahua</option>
                                                      <option data-offset="-25200" value="Mazatlan">(GMT-07:00) Mazatlan</option>
                                                      <option data-offset="-21600" value="Central America">(GMT-06:00) Central America</option>
                                                      <option data-offset="-21600" value="Guadalajara">(GMT-06:00) Guadalajara</option>
                                                      <option data-offset="-21600" value="Mexico City">(GMT-06:00) Mexico City</option>
                                                      <option data-offset="-21600" value="Monterrey">(GMT-06:00) Monterrey</option>
                                                      <option data-offset="-21600" value="Saskatchewan">(GMT-06:00) Saskatchewan</option>
                                                      <option data-offset="-18000" value="Bogota">(GMT-05:00) Bogota</option>
                                                      <option data-offset="-18000" value="Lima">(GMT-05:00) Lima</option>
                                                      <option data-offset="-18000" value="Quito">(GMT-05:00) Quito</option>
                                                      <option data-offset="-16200" value="Caracas">(GMT-04:30) Caracas</option>
                                                      <option data-offset="-14400" value="Atlantic Time (Canada)">(GMT-04:00) Atlantic Time (Canada)</option>
                                                      <option data-offset="-14400" value="La Paz">(GMT-04:00) La Paz</option>
                                                      <option data-offset="-14400" value="Santiago">(GMT-04:00) Santiago</option>
                                                      <option data-offset="-12600" value="Newfoundland">(GMT-03:30) Newfoundland</option>
                                                      <option data-offset="-10800" value="Brasilia">(GMT-03:00) Brasilia</option>
                                                      <option data-offset="-10800" value="Buenos Aires">(GMT-03:00) Buenos Aires</option>
                                                      <option data-offset="-10800" value="Georgetown">(GMT-03:00) Georgetown</option>
                                                      <option data-offset="-10800" value="Greenland">(GMT-03:00) Greenland</option>
                                                      <option data-offset="-7200" value="Mid-Atlantic">(GMT-02:00) Mid-Atlantic</option>
                                                      <option data-offset="-3600" value="Azores">(GMT-01:00) Azores</option>
                                                      <option data-offset="-3600" value="Cape Verde Is.">(GMT-01:00) Cape Verde Is.</option>
                                                      <option data-offset="0" value="Casablanca">(GMT) Casablanca</option>
                                                      <option data-offset="0" value="Dublin">(GMT) Dublin</option>
                                                      <option data-offset="0" value="Edinburgh">(GMT) Edinburgh</option>
                                                      <option data-offset="0" value="Lisbon">(GMT) Lisbon</option>
                                                      <option data-offset="0" value="London">(GMT) London</option>
                                                      <option data-offset="0" value="Monrovia">(GMT) Monrovia</option>
                                                      <option data-offset="3600" value="Amsterdam">(GMT+01:00) Amsterdam</option>
                                                      <option data-offset="3600" value="Belgrade">(GMT+01:00) Belgrade</option>
                                                      <option data-offset="3600" value="Berlin">(GMT+01:00) Berlin</option>
                                                      <option data-offset="3600" value="Bern">(GMT+01:00) Bern</option>
                                                      <option data-offset="3600" value="Bratislava">(GMT+01:00) Bratislava</option>
                                                      <option data-offset="3600" value="Brussels">(GMT+01:00) Brussels</option>
                                                      <option data-offset="3600" value="Budapest">(GMT+01:00) Budapest</option>
                                                      <option data-offset="3600" value="Copenhagen">(GMT+01:00) Copenhagen</option>
                                                      <option data-offset="3600" value="Ljubljana">(GMT+01:00) Ljubljana</option>
                                                      <option data-offset="3600" value="Madrid">(GMT+01:00) Madrid</option>
                                                      <option data-offset="3600" value="Paris">(GMT+01:00) Paris</option>
                                                      <option data-offset="3600" value="Prague">(GMT+01:00) Prague</option>
                                                      <option data-offset="3600" value="Rome">(GMT+01:00) Rome</option>
                                                      <option data-offset="3600" value="Sarajevo">(GMT+01:00) Sarajevo</option>
                                                      <option data-offset="3600" value="Skopje">(GMT+01:00) Skopje</option>
                                                      <option data-offset="3600" value="Stockholm">(GMT+01:00) Stockholm</option>
                                                      <option data-offset="3600" value="Vienna">(GMT+01:00) Vienna</option>
                                                      <option data-offset="3600" value="Warsaw">(GMT+01:00) Warsaw</option>
                                                      <option data-offset="3600" value="West Central Africa">(GMT+01:00) West Central Africa</option>
                                                      <option data-offset="3600" value="Zagreb">(GMT+01:00) Zagreb</option>
                                                      <option data-offset="7200" value="Athens">(GMT+02:00) Athens</option>
                                                      <option data-offset="7200" value="Bucharest">(GMT+02:00) Bucharest</option>
                                                      <option data-offset="7200" value="Cairo">(GMT+02:00) Cairo</option>
                                                      <option data-offset="7200" value="Harare">(GMT+02:00) Harare</option>
                                                      <option data-offset="7200" value="Helsinki">(GMT+02:00) Helsinki</option>
                                                      <option data-offset="7200" value="Istanbul">(GMT+02:00) Istanbul</option>
                                                      <option data-offset="7200" value="Jerusalem">(GMT+02:00) Jerusalem</option>
                                                      <option data-offset="7200" value="Kyiv">(GMT+02:00) Kyiv</option>
                                                      <option data-offset="7200" value="Pretoria">(GMT+02:00) Pretoria</option>
                                                      <option data-offset="7200" value="Riga">(GMT+02:00) Riga</option>
                                                      <option data-offset="7200" value="Sofia">(GMT+02:00) Sofia</option>
                                                      <option data-offset="7200" value="Tallinn">(GMT+02:00) Tallinn</option>
                                                      <option data-offset="7200" value="Vilnius">(GMT+02:00) Vilnius</option>
                                                      <option data-offset="10800" value="Baghdad">(GMT+03:00) Baghdad</option>
                                                      <option data-offset="10800" value="Kuwait">(GMT+03:00) Kuwait</option>
                                                      <option data-offset="10800" value="Minsk">(GMT+03:00) Minsk</option>
                                                      <option data-offset="10800" value="Nairobi">(GMT+03:00) Nairobi</option>
                                                      <option data-offset="10800" value="Riyadh">(GMT+03:00) Riyadh</option>
                                                      <option data-offset="12600" value="Tehran">(GMT+03:30) Tehran</option>
                                                      <option data-offset="14400" value="Abu Dhabi">(GMT+04:00) Abu Dhabi</option>
                                                      <option data-offset="14400" value="Baku">(GMT+04:00) Baku</option>
                                                      <option data-offset="14400" value="Moscow">(GMT+04:00) Moscow</option>
                                                      <option data-offset="14400" value="Muscat">(GMT+04:00) Muscat</option>
                                                      <option data-offset="14400" value="St. Petersburg">(GMT+04:00) St. Petersburg</option>
                                                      <option data-offset="14400" value="Tbilisi">(GMT+04:00) Tbilisi</option>
                                                      <option data-offset="14400" value="Volgograd">(GMT+04:00) Volgograd</option>
                                                      <option data-offset="14400" value="Yerevan">(GMT+04:00) Yerevan</option>
                                                      <option data-offset="16200" value="Kabul">(GMT+04:30) Kabul</option>
                                                      <option data-offset="18000" value="Islamabad">(GMT+05:00) Islamabad</option>
                                                      <option data-offset="18000" value="Karachi">(GMT+05:00) Karachi</option>
                                                      <option data-offset="18000" value="Tashkent">(GMT+05:00) Tashkent</option>
                                                      <option data-offset="19800" value="Chennai" selected="">(GMT+05:30) Chennai</option>
                                                      <option data-offset="19800" value="Kolkata">(GMT+05:30) Kolkata</option>
                                                      <option data-offset="19800" value="Mumbai">(GMT+05:30) Mumbai</option>
                                                      <option data-offset="19800" value="New Delhi">(GMT+05:30) New Delhi</option>
                                                      <option data-offset="20700" value="Kathmandu">(GMT+05:45) Kathmandu</option>
                                                      <option data-offset="21600" value="Almaty">(GMT+06:00) Almaty</option>
                                                      <option data-offset="21600" value="Astana">(GMT+06:00) Astana</option>
                                                      <option data-offset="21600" value="Dhaka">(GMT+06:00) Dhaka</option>
                                                      <option data-offset="21600" value="Ekaterinburg">(GMT+06:00) Ekaterinburg</option>
                                                      <option data-offset="21600" value="Sri Jayawardenepura">(GMT+06:00) Sri Jayawardenepura</option>
                                                      <option data-offset="23400" value="Rangoon">(GMT+06:30) Rangoon</option>
                                                      <option data-offset="25200" value="Bangkok">(GMT+07:00) Bangkok</option>
                                                      <option data-offset="25200" value="Hanoi">(GMT+07:00) Hanoi</option>
                                                      <option data-offset="25200" value="Jakarta">(GMT+07:00) Jakarta</option>
                                                      <option data-offset="25200" value="Novosibirsk">(GMT+07:00) Novosibirsk</option>
                                                      <option data-offset="28800" value="Beijing">(GMT+08:00) Beijing</option>
                                                      <option data-offset="28800" value="Chongqing">(GMT+08:00) Chongqing</option>
                                                      <option data-offset="28800" value="Hong Kong">(GMT+08:00) Hong Kong</option>
                                                      <option data-offset="28800" value="Krasnoyarsk">(GMT+08:00) Krasnoyarsk</option>
                                                      <option data-offset="28800" value="Kuala Lumpur">(GMT+08:00) Kuala Lumpur</option>
                                                      <option data-offset="28800" value="Perth">(GMT+08:00) Perth</option>
                                                      <option data-offset="28800" value="Singapore">(GMT+08:00) Singapore</option>
                                                      <option data-offset="28800" value="Taipei">(GMT+08:00) Taipei</option>
                                                      <option data-offset="28800" value="Ulaan Bataar">(GMT+08:00) Ulaan Bataar</option>
                                                      <option data-offset="28800" value="Urumqi">(GMT+08:00) Urumqi</option>
                                                      <option data-offset="32400" value="Irkutsk">(GMT+09:00) Irkutsk</option>
                                                      <option data-offset="32400" value="Osaka">(GMT+09:00) Osaka</option>
                                                      <option data-offset="32400" value="Sapporo">(GMT+09:00) Sapporo</option>
                                                      <option data-offset="32400" value="Seoul">(GMT+09:00) Seoul</option>
                                                      <option data-offset="32400" value="Tokyo">(GMT+09:00) Tokyo</option>
                                                      <option data-offset="34200" value="Adelaide">(GMT+09:30) Adelaide</option>
                                                      <option data-offset="34200" value="Darwin">(GMT+09:30) Darwin</option>
                                                      <option data-offset="36000" value="Brisbane">(GMT+10:00) Brisbane</option>
                                                      <option data-offset="36000" value="Canberra">(GMT+10:00) Canberra</option>
                                                      <option data-offset="36000" value="Guam">(GMT+10:00) Guam</option>
                                                      <option data-offset="36000" value="Hobart">(GMT+10:00) Hobart</option>
                                                      <option data-offset="36000" value="Melbourne">(GMT+10:00) Melbourne</option>
                                                      <option data-offset="36000" value="Port Moresby">(GMT+10:00) Port Moresby</option>
                                                      <option data-offset="36000" value="Sydney">(GMT+10:00) Sydney</option>
                                                      <option data-offset="36000" value="Yakutsk">(GMT+10:00) Yakutsk</option>
                                                      <option data-offset="39600" value="New Caledonia">(GMT+11:00) New Caledonia</option>
                                                      <option data-offset="39600" value="Solomon Is.">(GMT+11:00) Solomon Is.</option>
                                                      <option data-offset="39600" value="Vladivostok">(GMT+11:00) Vladivostok</option>
                                                      <option data-offset="43200" value="Auckland">(GMT+12:00) Auckland</option>
                                                      <option data-offset="43200" value="Fiji">(GMT+12:00) Fiji</option>
                                                      <option data-offset="43200" value="Kamchatka">(GMT+12:00) Kamchatka</option>
                                                      <option data-offset="43200" value="Magadan">(GMT+12:00) Magadan</option>
                                                      <option data-offset="43200" value="Marshall Is.">(GMT+12:00) Marshall Is.</option>
                                                      <option data-offset="43200" value="Wellington">(GMT+12:00) Wellington</option>
                                                      <option data-offset="46800" value="Nuku'alofa">(GMT+13:00) Nuku'alofa</option>
                                                  </select>
                                                </div>
                                        </div>
                                    </div>
                                    <div class="span10">
                                        <a href="#basic_info_form" class="btn btn-primary pull-right" rel="submit" callback="show_offerings">
                                         <span class="ajax-button-label" data-loading="Please Wait">Start Class</span></a>
                                    </div>
                                </div>
                       </form>
                    </div>
                </div>
            </div>
            <div id="offerings" class="item">
                <div class="row">
                    <div class="span12 trans-block" style="min-height:500px;">
                        <form id="offerings_form" method="POST" action="/save_user_profile/">
                            {% csrf_token %}
                            <input type="hidden" value="2" name="step"/>
                            <div class="row">
                               <div class="span12" style="margin-top:30px;">
                                    <h2 style="padding-left:50px;float:left">Offerings</h2>
                               </div>
                               <div class="span12 offset1" style="padding-top:20px">
                                    <div class="control-group">
                                        <label class="control-label" for="input01" style="text-align:left;width:100%">Select one of the Offerings</label>
                                        <div class="controls" style="margin-left:0px">
                                            <input type="hidden" name="prefered_offerings" />
                                            <select id="prefered_thisoffering" multiple="multiple" style="width:74.5%;">
                                            {% for session in sessions %}
                                                <option value="{{ session.offering.id }}" data-subject="{{ session.offering.course.subject }}" data-start_date="{{ session.date_start}}" data-end_date="{{ session.date_end}}" data-medium="{{ session.offering.language }}">{{ session.offering }}</option>
                                                <!--<button type="submit" class="btn" style="margin-left: 10px;padding: 0px 4px 0px 4px !important;"><i class="icon-ok"></i></button>-->
                                            {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                               </div>
                                <div class="span10">
                                    <a href="#offerings_form" class="btn btn-primary pull-right" rel="submit" callback="show_preferences" pre-call="pre_profile_save">
                                        <span class="ajax-button-label" data-loading="Please Wait">Preferences</span>
                                    </a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div id="preferences" class="item">
                <div class="row">
                    <div class="span12 trans-block" style="min-height:500px;">
                        <div class="row">
                            <div class="span12" style="margin-top:30px;">
                                <h2 class=="pull-left" style="padding-left:50px;">Preferences</h2>
                            </div>
                        </div>
                        <form id="preferences_form" class="form-horizontal" method="POST" action="/save_user_profile/" >
                            {% csrf_token %}
                            <input type="hidden" value="3" name="step" />
                            <div class="row">
                                <div class="span6 offset1" style="padding-top:30px">
                                    <div class="control-group">
                                            <label class="control-label text-left">Prefered days</label>
                                            <div class="timing-wrapper">
                                                <input type="hidden" name="prefered_days" />
                                                <input type="hidden" name="prefered_timings" />
                                                <div class="timing-inner-wrapper controls">
                                                    <!--<div id="prefered_days" class="controls">-->
                                                        <select id="prefered_days" class="span1">
                                                            <option value="Mon">Mon</option>
                                                            <option value="Tue">Tue</option>
                                                            <option value="Wed">Wed</option>
                                                            <option value="Thu">Thu</option>
                                                            <option value="Fri">Fri</option>
                                                            <option value="Sat">Sat</option>
                                                            <option value="Sun">Sun</option>
                                                        </select>
                                                        <select class="span1" name="prefered_timings_mor"  >
                                                                <option>From</option>
                                                            {% for i in 1234567891011|make_list %}
                                                                <option value="{{ forloop.counter0 }}">{{ forloop.counter0 }}:00</option>
                                                            {% endfor %}
                                                            {% for i in 12345678910|make_list %}
                                                                <option value="{{ forloop.counter|add_digits:12 }}">{{ forloop.counter|add_digits:12 }}:00</option>
                                                            {% endfor %}
                                                        </select>
                                                        <select class="span1" name="prefered_timings_eve" >
                                                                <option>To</option>
                                                            {% for i in 1234567891011|make_list %}
                                                                <option value="{{ forloop.counter0 }}">{{ forloop.counter0 }}:00</option>
                                                            {% endfor %}
                                                            {% for i in 12345678910|make_list %}
                                                                <option value="{{ forloop.counter|add_digits:12 }}">{{ forloop.counter|add_digits:12 }}:00</option>
                                                            {% endfor %}
                                                        </select>
                                                        <a class="btn add-timing"><i class="icon-plus" style="background-position: -408px -96px;"></i></a>
                                                    <!--</div>-->
                                                </div>
                                                <div style="clear:both"></div>
                                            </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label text-left">Prefered Subjects</label>
                                        <div class="controls">
                                            <input type="hidden" name="prefered_subjects" />
                                            <select id="prefered_subjects" multiple="multiple" class="span2" >
                                                {% for subject in subjects %}
                                                    <option value="{{ subject }}">{{ subject }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label text-left">Role</label>
                                            <div class="controls">
                                                <input type="hidden" name="prefered_roles" />
                                                <select id="prefered_roles" multiple="multiple" class="span2" >
                                                    {% for role in roles %}
                                                        <option value="{{ role }}">{{ role }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                    </div>
                               </div>
                               <div class="span5" style="padding-top:30px;">
                                    <!--<div class="control-group">
                                        <label class="control-label" for="select01"  style="text-align:left;">Role</label>
                                            <div class="controls">
                                                <input type="hidden" name="prefered_roles" />
                                                <select id="prefered_roles" multiple="multiple" class="span2" >
                                                    {% for role in roles %}
                                                        <option value="{{ role }}">{{ role }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                    </div>-->
                                    <div class="control-group">
                                            <label class="control-label text-left">Medium</label>
                                            <div class="controls">
                                                <input type="hidden" name="prefered_medium">
                                                <select id="medium" multiple="multiple" class="span2">
                                                    <option>Telugu</option>
                                                    <option>English</option>
                                                    <option>Hindi</option>
                                                </select>
                                            </div>
                                    </div>
                                    <div class="control-group">
                                            <label class="control-label text-left">Available from</label>
                                            <div class="controls">
                                                <input type="text" class="span2" id="from-date" name="from_date" value="{% if user_profile.from_date %}{{ user_profile.from_date.year }}-{{ user_profile.from_date.month }}-{{ user_profile.from_date.day }}{% endif %}">
                                            </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label text-left">Available upto</label>
                                        <div class="controls">
                                            <input type="text" class="span2" id="to-date" name="to_date" value="{% if user_profile.to_date %}{{ user_profile.to_date.year }}-{{ user_profile.to_date.month }}-{{ user_profile.to_date.day }}{% endif %}">
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <div class="controls">
                                            <a rel="submit" href="#preferences_form" class="btn btn-primary pull-right" pre-call="pre_profile_save" style="margin-right:80px;">
                                                <span class="ajax-button-label" data-loading="Please Wait">Save</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block bottom_scripts %}
    {{ block.super }}
    <script>
        $(document).ready(function(){

           var country = "{{ user_profile.country}}";
           $("select[name='country']").children("option[value='"+ country +"']").attr({"selected": "selected"});

           var time_zone = "{{user_profile.time_zone}}";
           $("select[name='time_zone']").children("option[value='"+ time_zone + "']").attr({"selected" : "selected"});

            var curr_date = new Date(),
                curr_day = curr_date.getDate(),
                curr_month = curr_date.getMonth() + 1,
                curr_year = curr_date.getFullYear(),
                min_date = curr_year +"-"+ curr_month +"-"+ curr_day;

            var future_date = new Date(curr_date.setMonth(curr_date.getMonth()+1.5)),
                future_day = future_date.getDate(),
                future_month = future_date.getMonth() + 1,
                future_year = future_date.getFullYear(),
                max_date = future_year +"-"+ future_month +"-"+ future_day;

            $("input[name='from_date']").datepicker({
                dateFormat: "yy-mm-dd",
                minDate: min_date,
            });
            $("input[name='to_date']").datepicker({
                dateFormat: "yy-mm-dd",
                minDate: max_date,
            });
            $(".add-timing").click(function(e) {
                var $wrapper = $(this).parents("div.timing-wrapper");
                var $clone = $wrapper.children("div.timing-inner-wrapper").slice(0,1).clone(true);
                $wrapper.append($clone);
                $(".add-timing").hide();
                $(".add-timing").last().show();
                e.preventDefault();
            });
            var pref_subjects = "{{ user_profile.pref_subjects }}";
            pref_subjects = pref_subjects.split(";");
            for( var subject in pref_subjects )
            {
                $("#prefered_subjects").children("option[value='" + pref_subjects[subject] + "']").attr({"selected":"selected"});
            }

            var pref_roles = "{{ user_profile.pref_roles}}";
            pref_roles = pref_roles.split(";");
            for( var role in pref_roles )
            {
                $("#prefered_roles").children("option[value='" + pref_roles[role] + "']").attr({"selected":"selected"});
            }

            var pref_medium = "{{ user_profile.pref_medium }}";
            pref_medium = pref_medium.split(";");
            for( var medium in pref_medium )
            {
                $("#medium").children("option[value='" + pref_medium[medium] + "']").attr({"selected":"selected"});
            }

            var pref_offerings = [{% for offering in  user_profile.pref_offerings.all %}"{{ offering }}"{% if not forloop.last %},{% endif %}{% endfor %}];
            for( var offering in pref_offerings )
            {
                //$("#prefered_thisoffering").children("option[value='" + pref_offerings[offering] + "']").attr({"selected":"selected"});
                $.each($("#prefered_thisoffering").children(), function(){
                    if($(this).text() == pref_offerings[offering]){
                        $(this).attr({"selected":"selected"});
                    }
                });
            }

            var pref_slots = "{{ user_profile.pref_slots }}";
            var pref_days = "{{ user_profile.pref_days }}";
            pref_days = pref_days.split(";");
            pref_slots = pref_slots.split(";");
            pref_slot1 = pref_slots[0].split("-");
            $children1 = $("div.timing-inner-wrapper").children("select");
            $children1.eq(0).children("option[value='" + pref_days[0] +"']").attr({"selected":"selected"});
            $children1.eq(1).children("option[value='"+ pref_slot1[0] +"']").attr({"selected": "selected"});
            $children1.eq(2).children("option[value='"+ pref_slot1[1] +"']").attr({"selected": "selected"});

            pref_slots = pref_slots.slice(1);
            pref_days = pref_days.slice(1);
            if(pref_slots.length > 0){
                $.each(pref_slots,function(i,v){
                    curr_pref_slot = pref_slots[i].split("-");
                     curr_day = pref_days[i];
                    $(".add-timing").trigger("click");
                    $children = $("div.timing-inner-wrapper").eq(i).children("select");
                     $children .eq(0).children("option[value='"+ curr_day+"']").attr({"selected":"selected"});
                    $children.eq(1).children("option[value='"+ curr_pref_slot[0] +"']").attr({"selected": "selected"});
                    $children.eq(2).children("option[value='"+ curr_pref_slot[1] +"']").attr({"selected": "selected"});
                });
           }

        });
    </script>
{% endblock %}

